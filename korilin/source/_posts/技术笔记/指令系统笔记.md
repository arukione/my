---
title: 指令系统笔记
date: 2020-9-5
categories: 技术笔记
tags:
    - 计算机组成
---

### 来源书籍

**计算机组成与结构 / 王爱英主编。---5 版。——北京：清华大学出版社，2013.1（2020.1 重印）**

### 指令格式

**指令包含的信息：**
操作码：具体说明操作的性质及功能。
操作数的地址：CPU 通过该地址
操作结果的存储地址：把对操作数的处理结果保存到该地址中
下一条指令的地址：当程序顺序执行时，下一条指令的地址由程序计数器（PC）给出，仅当改变程序的运行顺序（如转移、调用子程序）时，下一条指令的地址才由指令给出。

**1. 零地址指令**
- 格式：| OPCODE |
- OPCODE：操作码

```
指令中只有操作码，而没有操作数或没有操作数地址。

指令的两种可能：
1. 无须任何操作数
2. 操作数地址是默认的
```

**2. 一地址指令**
- 格式：| OPCODE | A |
- OPCODE：操作码
- A：操作数的存储器地址或寄存器地址

```
指令中只给出一个地址，该地址既是操作数的地址，又是操作结果的存储地址。
```

**3. 三地址指令**
- 格式：| OPCODE | A1 | A2 |
- OPCODE：操作码
- A1：第一个源操作数的存储地址或寄存器地址
- A2：第二个源操作数和存放操作结果的存储器地址或寄存器地址

```
两个地址指出两个源操作数地址，其中一个还是存放结果的目的地址。
对两个源操作数进行操作码所规定的操作后，将结果存入目的地址。
```

**4. 多地址指令**
某些性能强的计算机进行批数据处理的指令，用多个地址指出元数据存放的首地址、长度以及运算结果存放地址等信息。

**其它**

- 零地址、一地址和二地址指令：指令短、执行速度快、硬件实现简单
- 三地址和多地址指令：功能强、便于编程
- 指令和数据一样都是以二进制码的形式存储
- 指令的地址：由程序计数器（PC）规定
- 数据的地址：由指令规定的
- 所有指令在数据运行前后保持不变

### 指令长度和数据字长

数据字长决定了计算机的运算精度，字长越长，计算机的运算精度越高
地址码长度决定了指令直接寻址能力，若为 n 位，则给出的 n 位直接地址可寻址 2^n 个字或字节

### 寻址方式

**1. 直接寻址**

| OP | ... 指令字 | M | A |
- M：寻址方式
- A：操作数地址

指令的地址码部分直接给出的操作数在存储器中的地址

**2. 寄存器寻址**

计算机中央处理器一般设置有一定数量的通用寄存器，可以存放操作数、操作数地址或中间结果
指令地址码部分给出某一通用寄存器地址，所需的操作数就在那一寄存器中

**3. 基址寻址**

计算机中设置一个专用的基址寄存器，或由指令指定一个通用寄存器为基址寄存器
操作数的地址由基址寄存器的内容和指令的地址码 A 相加得到
地址码 A 通常被称为位移量（disp），也可以用其它方法获得位移量

```
基址寄存器主要用于为程序或数据分配存储区
实现从浮动程序的逻辑地址（编写程序时所使用的地址）
到存储器的物理地址（程序在存储器中的实际地址，又是称为有效地址）的转换。
```

```
通常基址寄存器中的值只能由系统程序设定，由特权指令执行，而不能被一般用户指令所修改，因此保证了系统的安全性
```

**4. 变址寻址**

指令地址码部分给出的地址 A 和指定的变址寄存器 X 的内容通过加法器相加，所得的和作为地址从存储器中读出所需的操作数

**5. 间接寻址**

根据指令的地址码是操作数的地址或指令的地址
根据地址码指的是寄存器地址还是存储器地址，可分为寄存器间接寻址和存储器间接寻址

**6. 相对寻址**

程序计数器 PC 的内容（即当前执行指令的地址）与指令的地址码部分给出的位移量（Disp）之和作为操作数的地址或转移地址，称为相对寻址

```
相对寻址主要用于转移指令，执行本条指令后，将转移到（PC）+Disp，（PC）为程序计数器的内容
在程序与数据分区存放的情况下，不用相对寻址来确定操作数地址
```

相对寻址特点：
1. 转移地址不是固定的，它随着 PC 值得变化而变化，并且总与 PC 相差一个固定值 disp
2. 位移量可正、可负，通常用补码表示。如果位移量为 n 位，则着用方式的寻址范围在（PC）-2^（n-1）到（PC）+2^(n-1)-1 之间

**7. 立即数寻址**

所需的操作数由指令的地址码部分直接给出，就称为立即数（或直接数）寻址方式

特点：取指时，操作码和一个操作数同时呗取出，减少了访问存储器次数，提高了指令的执行速度

**8. 堆栈寻址**

？

### 指令分类

1. 算数逻辑运算指令
2. 唯一操作指令
3. 浮点运算指令
4. 十进制运算指令
5. 字符串处理指令
6. 数据传输指令
7. 转移指令
8. 堆栈及堆栈操作指令
9. 输入输出（I/O）指令
10. 特权指令
11. 其它指令
    - 向量指令
    - 多处理机指令
    - 控制指令

### RISC

精简计算机（reduced instruction set computer, RISC）

计算机执行程序所需要的时间 P 可用下式表示：

```
P = I x CPI x T
I是程序在机器上运行的指令数
CPI为执行每条指令所需的平均周期数
T是每个机器周期的时间
```

**特点：**

1. 优先选取使用频率较高的简单指令以及有用而不复杂的指令
2. 指令长度固定，指令格式种类少，寻址方式种类少
3. 只有取数 / 存数指令（load/store）访问存储器，数据在寄存器和存储器之间传送，其余指令的操作数都在寄存器之间进行
4. CPU 中通用寄存器数量相当多，算数逻辑运算指令的操作数都在通用寄存器中存取
5. 大部分指令在一个或小于一个机器周期内完成
6. 以硬布线控制逻辑为主，不用或少用微码控制
7. 特别重视程序编译优化工作，减少程序执行时间
